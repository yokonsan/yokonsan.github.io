<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="yokonsan" />
	
	
	
	<title>pdfGPT｜无需阅读，让 PDF 和自己对话 ｜ 乾之 三爻</title>
	
    
    
    <meta name="description" content="目前 ChatGPT 无法直接与外部数据进行交互。如果我们能将自己的数据投喂给它，并且让它根据数据与我们对话，那么我们就能将 ChatGPT 变成自己的知识库。这种方法将使 ChatGPT 更加智能化和可定制化，更好地满足用户的需求。 因 OpenAI gpt-3" />
    

    
    
    <meta name="keywords" content="技术, 生活, 分享" />
    

	
    
    <link rel="shortcut icon" href="https://yokonsan.com/images/favicon.ico" />

    <link rel="stylesheet" type="text/css" media="screen" href="https://yokonsan.com/css/normalize.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://yokonsan.com/css/zozo.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://yokonsan.com/css/highlight.css" />

    
    
</head>

<body>
    <div class="main animate__animated animate__fadeInDown">
        <div class="nav_container animated fadeInDown">
    <div class="site_nav" id="site_nav">
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/posts/">Archive</a>
            </li>
            
            <li>
                <a href="/tags/">Tags</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
            <li>
                <a href="/links/">Links</a>
            </li>
            
        </ul>
    </div>
    <div class="menu_icon">
        <a id="menu_icon"><i class="ri-menu-line"></i></a>
    </div>
</div>
        <div class="header animated fadeInDown">
    <div class="site_title_container">
        <div class="site_title">
            <h1>
                <a href="https://yokonsan.com/">
                    <span>乾之 三爻</span>
                </a>
            </h1>
        </div>
        <div class="description">
            <p class="sub_title">yokon&#39;s blog</p>
            <div class="my_socials">
                
                
                <a href="https://github.com/yokonsan" title="github" target="_blank"><i class="ri-github-fill"></i></a>
                
                
                
                <a href="https://ai.yokonsan.com" title="instagram" target="_blank"><i class="ri-instagram-fill"></i></a>
                
                
                <a href="https://yokonsan.com/index.xml" type="application/rss+xml" title="rss" target="_blank"><i
                        class="ri-rss-fill"></i></a>
            </div>
        </div>
    </div>
</div>
        <div class="content">
            <div class="post_page">
                <div class="post animate__animated animate__fadeInDown">
                    <div class="post_title post_detail_title">
                        <h2><a href='/posts/2023/4/experience-of-using-pdfgpt/'>pdfGPT｜无需阅读，让 PDF 和自己对话</a></h2>
                        <span class="date">2023.04.30</span>
                    </div>
                    <div class="post_content markdown"><p>目前 ChatGPT 无法直接与外部数据进行交互。如果我们能将自己的数据投喂给它，并且让它根据数据与我们对话，那么我们就能将 ChatGPT 变成自己的知识库。这种方法将使 ChatGPT 更加智能化和可定制化，更好地满足用户的需求。</p>
<p>因 OpenAI <code>gpt-3.5-turbo</code>模型有 4096 个 tokens 的限制，我们不能将一个大文本传递给 OpenAI。一个好的解决方法是使用 embeddings，但这会消耗我们的 tokens。而本文介绍的 pdfGPT，使用<a href="https://tfhub.dev/google/collections/universal-sentence-encoder/1">universal-sentence-encoder</a>改进 embeddings。每次用户输入问题时，他会搜索文档中相关连的内容，然后将它传递给 ChatGPT，由 ChatGPT 回答用户的问题。</p>
<h2 id="是什么">是什么</h2>
<p>pdfGPT 允许用户使用 ChatGPT 与上传的 PDF 文件进行交流。该应用程序智能地将文档分成更小的块，并使用强大的<code>Deep Averaging Network Encoder</code>来生成 embeddings。</p>
<p>pdfGPT 对 pdf 文件内容进行语义搜索，并将最相关的 embeddings 传递给 ChatGPT。pdfGPT 自定义逻辑生成精确的回答。回答内容会将引用信息所在的文件页码放在方括号（[]）中，从而增加回答的可信度，并有助于快速定位相关信息。</p>
<p>开源地址：</p>
<p><a href="https://github.com/bhaskatripathi/pdfGPT">https://github.com/bhaskatripathi/pdfGPT</a></p>
<h3 id="项目-uml">项目 UML</h3>
<p><img src="/image/post46/post46_1.png" alt="post46_1.png"></p>
<h3 id="项目流程图">项目流程图</h3>
<p><img src="/image/post46/post46_2.png" alt="post46_2.png"></p>
<h2 id="使用体验">使用体验</h2>
<p>这次我们依然白嫖<a href="https://colab.research.google.com">Google colab</a>的服务。现在让我们来体验下 pdfGPT 的能力吧。</p>
<h3 id="安装依赖">安装依赖</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">!git clone https://github.com/bhaskatripathi/pdfGPT.git
</span></span><span class="line"><span class="cl">!python -m pip install --upgrade pip
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">!pip install PyMuPDF
</span></span><span class="line"><span class="cl">!pip install numpy
</span></span><span class="line"><span class="cl">!pip install scikit-learn
</span></span><span class="line"><span class="cl">!pip install tensorflow
</span></span><span class="line"><span class="cl">!pip install tensorflow-hub
</span></span><span class="line"><span class="cl">!pip install openai
</span></span><span class="line"><span class="cl">!pip install gradio
</span></span></code></pre></div><p>这里直接根据依赖文件 <code>pip install -r requirements.txt</code> 时，会出现意料之外的报错。懒得去理会报错原因，我们直接手动安装这些依赖即可。</p>
<h3 id="启动">启动</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">%cd pdfGPT
</span></span><span class="line"><span class="cl">!python app.py
</span></span></code></pre></div><p>项目通过 <code>gradio</code> 展示。我们直接根据表单提示，输入 OpenAI API key，并且上传我们的 PDF 文件或者输入文件的 URL 地址。然后我们在问题表单填入我们的问题，和 PDF 文件进行交流。</p>
<p>我以之前写的 C 站数据分析文章生成的 PDF 文件为例，我们向它提问：<code>chilloutmix</code> 是什么。它正确的返回了答案，并且标注了数据出处所在的页码。</p>
<p><img src="/image/post46/post46_3.png" alt="post46_3.png"></p>
<p>我们可以修改代码，添加 gradio 的 launch 参数<code>share=True</code>，向朋友分享自己的服务。添加 OpenAI key 输入框参数 <code>type=&quot;password&quot;</code>，使得前端输入 key 时，不明文展示在前端。</p>
<h2 id="不足">不足</h2>
<p>当我们上传中文 PDF 大文件时，会出现<code>openai.error.InvalidRequestError</code> 报错。我们可以使用 OpenAI 官方提供的<code>tiktoken</code> 库计算 tokens 来拆分文本，以解决这个问题。这里大家自行处理。</p>
<h2 id="总结">总结</h2>
<p>本文介绍了 <code>pdfGPT</code> ，并体验了它的能力。它向我们展示了通过投喂 PDF 文件内容给 ChatGPT，让他成为我们私人知识库的能力。
虽然它还有很大的不足，但它只是个 demo，大家可以自由探索。</p>
<hr>
<p>我思考了下，这个方案比较适合的场景：<strong>就是那些不看文档就直接问问题的同事或者甲方，让他们自己问去吧。</strong></p>
</div>
                    <div class="post_footer">
                        
                        <div class="meta">
                            <div class="info">
                                <span class="field tags">
                                    <i class="ri-stack-line"></i>
                                    
                                    <a href="https://yokonsan.com/tags/chatgpt/">ChatGPT</a>
                                    
                                </span>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                
                <div class="doc_comments"></div>
                
            </div>
        </div>
    </div>
    <a id="back_to_top" href="#" class="back_to_top"><i class="ri-arrow-up-s-line"></i></a>
    <footer class="footer">
    <div class="powered_by">
        <a href="https://github.com/varkai/hugo-theme-zozo">Designed by zozo | </a>
        <a href="http://www.gohugo.io/">Proudly published with Hugo | </a>
        <a href="https://beian.miit.gov.cn/">苏ICP备17028833号-3</a>
    </div>

    <div class="footer_slogan">
        <span>君子终日乾乾，夕惕若厉，无咎。</span>
        
    </div>

    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?7256012830beb794d5f4468b53b5891e";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
    </script>
        
</footer>
    <script src="https://yokonsan.com/js/jquery-3.5.1.min.js"></script>
<link href="https://yokonsan.com/css/fancybox.min.css" rel="stylesheet">
<script src="https://yokonsan.com/js/fancybox.min.js"></script>
<script src="https://yokonsan.com/js/zozo.js"></script>


<script type="text/javascript" async
    src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
                processEscapes: true,
                processEnvironments: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                TeX: {
                    equationNumbers: { autoNumber: "AMS" },
                    extensions: ["AMSmath.js", "AMSsymbols.js"]
                }
            }
        });

        MathJax.Hub.Queue(function () {
            
            
            
            var all = MathJax.Hub.getAllJax(), i;
            for (i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

<style>
    code.has-jax {
        font: inherit;
        font-size: 100%;
        background: inherit;
        border: inherit;
        color: #515151;
    }
</style>



</body>

</html>