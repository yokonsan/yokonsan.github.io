<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="yokonsan" />
	
	
	
	<title>Stable-Diffusion 中文自部署服务共享 ｜ 乾之 三爻</title>
	
    
    
    <meta name="description" content="上篇文章介绍了 Stable-Diffusion 的安装部署，结尾的时候遗留了几个问题： SD-WebUI 中文本地化 SD-WebUI 实例共享 SD-WebUI 参数详解 本篇文章主要说明如何使用本地化插件，以及如何共享自己的服务，并简要说明下生成参数。 中文本地化 webui 默认是英文，因为名词" />
    

    
    
    <meta name="keywords" content="技术, 生活, 分享" />
    

	
    
    <link rel="shortcut icon" href="https://yokonsan.com/images/favicon.ico" />

    <link rel="stylesheet" type="text/css" media="screen" href="https://yokonsan.com/css/normalize.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://yokonsan.com/css/zozo.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://yokonsan.com/css/highlight.css" />

    
    
</head>

<body>
    <div class="main animate__animated animate__fadeInDown">
        <div class="nav_container animated fadeInDown">
    <div class="site_nav" id="site_nav">
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/posts/">Archive</a>
            </li>
            
            <li>
                <a href="/tags/">Tags</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
            <li>
                <a href="/links/">Links</a>
            </li>
            
        </ul>
    </div>
    <div class="menu_icon">
        <a id="menu_icon"><i class="ri-menu-line"></i></a>
    </div>
</div>
        <div class="header animated fadeInDown">
    <div class="site_title_container">
        <div class="site_title">
            <h1>
                <a href="https://yokonsan.com/">
                    <span>乾之 三爻</span>
                </a>
            </h1>
        </div>
        <div class="description">
            <p class="sub_title">yokon&#39;s blog</p>
            <div class="my_socials">
                
                
                <a href="https://github.com/yokonsan" title="github" target="_blank"><i class="ri-github-fill"></i></a>
                
                
                
                <a href="https://ai.yokonsan.com" title="instagram" target="_blank"><i class="ri-instagram-fill"></i></a>
                
                
                <a href="https://yokonsan.com/index.xml" type="application/rss+xml" title="rss" target="_blank"><i
                        class="ri-rss-fill"></i></a>
            </div>
        </div>
    </div>
</div>
        <div class="content">
            <div class="post_page">
                <div class="post animate__animated animate__fadeInDown">
                    <div class="post_title post_detail_title">
                        <h2><a href='/posts/2023/4/stable-diffusion-service-share/'>Stable-Diffusion 中文自部署服务共享</a></h2>
                        <span class="date">2023.04.15</span>
                    </div>
                    <div class="post_content markdown"><p>上篇文章介绍了 Stable-Diffusion 的安装部署，结尾的时候遗留了几个问题：</p>
<ul>
<li>SD-WebUI 中文本地化</li>
<li>SD-WebUI 实例共享</li>
<li>SD-WebUI 参数详解</li>
</ul>
<p>本篇文章主要说明如何使用本地化插件，以及如何共享自己的服务，并简要说明下生成参数。</p>
<h2 id="中文本地化">中文本地化</h2>
<p>webui 默认是英文，因为名词比较多，国人体验会不太好。如果能不上手修改代码并将 UI
改成中文，会更好些。好在官方给我们提供了很方便的解决方案。</p>
<h3 id="创建本地化文件">创建本地化文件</h3>
<p>第一个方法是在设置界面找到 <code>Download localization template</code> 按钮，点击它会下载一个本地化文件的模板。编辑并翻译该文件每个词的映射，然后将它放在<code>extensions/stable-diffusion-webui-localization-zh_CN/localizations/</code>文件夹下，并重命名为<code>zh_CN.json</code>。</p>
<h3 id="下载本地化插件">下载本地化插件</h3>
<p>第二个方法是使用别人的本地化插件。推荐插件地址：<a href="https://github.com/dtlnor/stable-diffusion-webui-localization-zh_CN">stable-diffusion-webui-localization-zh_CN</a></p>
<p>可直接在 GitHub 下载压缩包，然后解压到目录<code>extensions</code>下。有开发基础的可以通过<code>git clone</code> 下载，可以通过<code>git pull</code>去更新插件。</p>
<p>当然 webui 也给了我们安装方法，如图：</p>
<p><img src="/image/post44/post44_1.png" alt="post44_1.png"></p>
<p>安装后记得重启下 webui。</p>
<h2 id="服务共享">服务共享</h2>
<p>因为 webui 使用了 Gradio 库，我们可以直接使用他的转发服务。</p>
<p>执行程序时添加启动参数<code>--share</code> 开启共享服务，添加<code>--gradio-auth</code>参数设备登录信息，后面跟上用户名和密码<code>username:password</code>。可以有多用户，使用英文逗号分隔即可。</p>
<p>windows 可直接编辑<code>webui-user.bat</code> 的<code>COMMANDLINE_ARGS</code>参数。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">COMMANDLINE_ARGS</span><span class="o">=</span><span class="s2">&#34;--share --gradio-auth yokonsan:666666&#34;</span>
</span></span></code></pre></div><h3 id="端口转发">端口转发</h3>
<p>添加启动参数<code>--listen</code>使服务监听外部网络连接。</p>
<p>启动后，你会得到一个形如<code>https://xxx.gradio.app</code> 的链接，这样你的朋友可以通过这个链接从别的客户端访问到你部署的 SD 服务了。</p>
<p>使用  <code>--listen</code>  会启用默认的安全保护设置，插件功能会失效。</p>
<h3 id="监听端口修改">监听端口修改</h3>
<p>参数  <code>--port xxxx</code>  修改默认端口<code>7860</code>，自定义服务监听的端口。</p>
<p>对于 Linux 系统，如需监听低于  <code>1024</code>  的任何端口，程序需要以  <code>root</code>  权限运行或授权  <code>CAP_NET_BIND_SERVICE</code>  能力，因此建议使用高于  <code>1024</code>  的端口。</p>
<h2 id="生成参数介绍">生成参数介绍</h2>
<p>本文不对每个参数做详细的说明，这里先简要介绍下。</p>
<blockquote>
<p>[!INFO] INFO
下面的内容是我直接使用 <a href="https://openai.yokonsan.com">ChatGPT 服务</a> 翻译的 <a href="https://wiki.installgentoo.com/wiki/Stable_Diffusion">stable-diffusion wiki</a> 内容。</p>
</blockquote>
<p>生成图像时，输入参数的名称在不同的界面之间略有不同，但它们通常具有相同的功能。
以下是这些参数的简要说明：</p>
<ul>
<li>Prompt（正向提示词）：生成图像的文字描述。</li>
<li>Negative prompt（反向提示词）：不希望在图像中出现的事物的文字描述。</li>
<li>Sampling Steps（采样步数）：扩散模型通过从随机高斯噪声向符合提示的图像迈出小步骤来工作。这是应该完成的步骤数量。更多的步骤意味着从噪声到图像的步骤更小、更精确。增加这个参数直接增加了生成图像所需的时间。收益递减，取决于采样器。</li>
<li>Sampling method（Sampler 采样器）：使用哪种采样器。Euler a（ancestral 简称）可以在步骤较少的情况下产生很大的多样性，但很难进行微小的调整。非 ancestral 采样器随着步骤数量的增加，产生的图像基本相同，如果不确定可以使用 LMS。</li>
<li>Batch count/n_iter（批次）：生成一组图像的批次数。</li>
<li>Batch size（每批数量）：同时生成的图像数量。增加这个值可以提高性能，但也需要更多的 VRAM。总图像数是这个值与批次计数相乘的结果。</li>
<li>CFG Scale（无分类器指导比例）：图像与提示的匹配程度。增加这个值会导致图像更接近您的提示词（根据模型），但也会在一定程度上降低图像质量。可以通过增加采样步骤来在一定程度上对抗这种影响。</li>
<li>Width（宽）：单个图像的宽度（以像素为单位）。增加这个值需要更多的 VRAM。随着分辨率的增加，大尺度上的图像连贯性（模型是在 512x512 上训练的）变差。非常小的值（例如 256 像素）也会降低图像质量。</li>
<li>Height（高）：与 Width 相同，但针对单个图像的高度。</li>
<li>Seed：随机数生成器的起始点。保持相同的种子可以多次生成相同（或几乎相同）的图像。没有比其他种子更好的种子，但如果您的输入参数略有变化，之前产生好结果的种子可能仍然会产生好结果。</li>
</ul>
</div>
                    <div class="post_footer">
                        
                        <div class="meta">
                            <div class="info">
                                <span class="field tags">
                                    <i class="ri-stack-line"></i>
                                    
                                    <a href="https://yokonsan.com/tags/ai%E7%BB%98%E7%94%BB/">AI绘画</a>
                                    
                                    <a href="https://yokonsan.com/tags/stablediffusion/">StableDiffusion</a>
                                    
                                </span>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                
                <div class="doc_comments"></div>
                
            </div>
        </div>
    </div>
    <a id="back_to_top" href="#" class="back_to_top"><i class="ri-arrow-up-s-line"></i></a>
    <footer class="footer">
    <div class="powered_by">
        <a href="https://github.com/varkai/hugo-theme-zozo">Designed by zozo | </a>
        <a href="http://www.gohugo.io/">Proudly published with Hugo | </a>
        <a href="https://beian.miit.gov.cn/">苏ICP备17028833号-3</a>
    </div>

    <div class="footer_slogan">
        <span>君子终日乾乾，夕惕若厉，无咎。</span>
        
    </div>

    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?7256012830beb794d5f4468b53b5891e";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
    </script>
        
</footer>
    <script src="https://yokonsan.com/js/jquery-3.5.1.min.js"></script>
<link href="https://yokonsan.com/css/fancybox.min.css" rel="stylesheet">
<script src="https://yokonsan.com/js/fancybox.min.js"></script>
<script src="https://yokonsan.com/js/zozo.js"></script>


<script type="text/javascript" async
    src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
                processEscapes: true,
                processEnvironments: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                TeX: {
                    equationNumbers: { autoNumber: "AMS" },
                    extensions: ["AMSmath.js", "AMSsymbols.js"]
                }
            }
        });

        MathJax.Hub.Queue(function () {
            
            
            
            var all = MathJax.Hub.getAllJax(), i;
            for (i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

<style>
    code.has-jax {
        font: inherit;
        font-size: 100%;
        background: inherit;
        border: inherit;
        color: #515151;
    }
</style>



</body>

</html>