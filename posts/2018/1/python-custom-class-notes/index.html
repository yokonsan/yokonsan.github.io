<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="yokonsan" />
	
	
	
	<title>Python的定制类笔记 ｜ 乾之 三爻</title>
	
    
    
    <meta name="description" content="前言 最近在阅读flask源码的时候，经常看到一些python类中，类似于__xxx__的变量和 函数名，这些大多是在python中有特殊用途的。Python的class中有许多类似于这样 的函数，我们用他" />
    

    
    
    <meta name="keywords" content="技术, 生活, 分享" />
    

	
    
    <link rel="shortcut icon" href="https://yokonsan.github.io/images/favicon.ico" />

    <link rel="stylesheet" type="text/css" media="screen" href="https://yokonsan.github.io/css/normalize.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://yokonsan.github.io/css/zozo.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://yokonsan.github.io/css/highlight.css" />

    
    
</head>

<body>
    <div class="main animate__animated animate__fadeInDown">
        <div class="nav_container animated fadeInDown">
    <div class="site_nav" id="site_nav">
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/posts/">Archive</a>
            </li>
            
            <li>
                <a href="/tags/">Tags</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
        </ul>
    </div>
    <div class="menu_icon">
        <a id="menu_icon"><i class="ri-menu-line"></i></a>
    </div>
</div>
        <div class="header animated fadeInDown">
    <div class="site_title_container">
        <div class="site_title">
            <h1>
                <a href="https://yokonsan.github.io/">
                    <span>乾之 三爻</span>
                </a>
            </h1>
        </div>
        <div class="description">
            <p class="sub_title">yokon&#39;s blog</p>
            <div class="my_socials">
                
                
                <a href="https://github.com/yokonsan" title="github" target="_blank"><i class="ri-github-fill"></i></a>
                
                
                <a href="https://yokonsan.github.io/index.xml" type="application/rss+xml" title="rss" target="_blank"><i
                        class="ri-rss-fill"></i></a>
            </div>
        </div>
    </div>
</div>
        <div class="content">
            <div class="post_page">
                <div class="post animate__animated animate__fadeInDown">
                    <div class="post_title post_detail_title">
                        <h2><a href='/posts/2018/1/python-custom-class-notes/'>Python的定制类笔记</a></h2>
                        <span class="date">2018.01.28</span>
                    </div>
                    <div class="post_content markdown"><h2 id="前言">前言</h2>
<p>最近在阅读<code>flask</code>源码的时候，经常看到一些<code>python</code>类中，类似于<code>__xxx__</code>的变量和
函数名，这些大多是在<code>python</code>中有特殊用途的。<code>Python</code>的<code>class</code>中有许多类似于这样
的函数，我们用他们来定制我们的类，来实现一些<code>class</code>本身不具有的方法。由于有些方
法我也不是很明白，为了能更好的理解他们，索性就做一个总结。参考谷歌的博客及<a href="http://python.usyiyi.cn/translate/python_352/reference/datamodel.html#special-method-names">官方
文档</a></p>
<p>先简单定义一个类：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Me</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</span></span></code></pre></div><h2 id="__call__">__call__</h2>
<p>在<code>Python</code>中，调用函数可以直接使用<code>abs(123)</code>来调用，而调用一个类的实例方法时，
都是使用<code>instance.method()</code>来调用。那如果我们想像调用函数那样调用实例，就需要
<code>__call__()</code>方法了。以上面的类为例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{name}</span><span class="se">\&#39;</span><span class="s1">s age is </span><span class="si">{age}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">age</span><span class="o">=</span><span class="n">age</span><span class="p">))</span>
</span></span></code></pre></div><p>直接调用它：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; me = Me(&#39;GuTianle&#39;)
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; me(20)
</span></span><span class="line"><span class="cl">GuTianle&#39;s age is 20.
</span></span></code></pre></div><p>其实在<code>Python</code>中，对象和函数的界限是很模糊的，函数可以动态创建出来，当然类的实
例对象也是动态创建出来的，如果类中有<code>__call__()</code>方法，那其实对象和函数没有根本
的区别。</p>
<p>如果有一个变量<code>a = 1</code>，我们如何判断实例<code>me</code>和<code>a</code>是对象或者函数还是变量呢？答案
是使用<code>callable()</code>函数，一个可被调用的对象就是一个<code>Callable</code>对象：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; callable(me) # Me类的实例
</span></span><span class="line"><span class="cl">True
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; callable(a) # 变量 a=1
</span></span><span class="line"><span class="cl">False
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; callable(abs) # 求绝对值的内置函数
</span></span><span class="line"><span class="cl">True
</span></span></code></pre></div><h2 id="__repr__">__repr__</h2>
<p><code>__repr__()</code>方法是比较常用的方法，通常用于调试，表示对象的主要信息。依然是上面
的例子：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; me = Me(&#39;GuTianle&#39;)
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; me
</span></span><span class="line"><span class="cl">&lt;__main__.Me object at 0x0000000002A01E48&gt;
</span></span></code></pre></div><p>返回的结果显然不是我们想要的，如果能直接打印出实例的信息就好了，解决方法是定义
<code>__repr__()</code>方法，让他返回一个我们需要的信息。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;&lt;Me object </span><span class="si">{name}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span></span></code></pre></div><p>接着打印实例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; me = Me(&#39;GuTianle&#39;)
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; me
</span></span><span class="line"><span class="cl">&lt;Me object GuTianle&gt;
</span></span></code></pre></div><h2 id="__getattr__">__getattr__</h2>
<p>仍然以上面的类为例，当我们调用他的<code>sex</code>属性时，由于他并不存在，就会报错：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; me = Me(&#39;GuTianle&#39;)
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; print(me.name)
</span></span><span class="line"><span class="cl">GuTianle
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; print(me.sex)
</span></span><span class="line"><span class="cl">Traceback (most recent call last):
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">AttributeError: &#39;Me&#39; object has no attribute &#39;sex&#39;
</span></span></code></pre></div><p>通常我们调用一个类的属性和方法时，如果调用的不存在，就会报错。这种情况，我们只
要给他加一个<code>sex</code>属性就好了。但是，有些情况我们并不需要<code>sex</code>属性，但是当调用
<code>sex</code>属性的属性的时候可以给他返回结果。这就需要定义一个<code>__getattr__()</code>方法来动
态返回一个属性：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="s1">&#39;Zhazhahui&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;sex&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;GuTianle&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	    	<span class="k">return</span> <span class="s1">&#39;male&#39;</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="s1">&#39;female&#39;</span>
</span></span></code></pre></div><p>现在再调用他：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; print(me.sex)
</span></span><span class="line"><span class="cl">&#39;male&#39;
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; print(me.name)
</span></span><span class="line"><span class="cl">&#39;GuTianle&#39;
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; print(me.height)
</span></span><span class="line"><span class="cl">None
</span></span></code></pre></div><p>但是如果我们在<code>__getattr__()</code>方法下，在判断<code>if attr == 'name':...</code>，当我们调用
<code>name</code>属性时，程序首先在类中查找是否有<code>name</code>属性，如果有，程序是不会执行
<code>__getattr__()</code>下的判断的。</p>
<p>此外，从上面的调用可以看到调用没有定义的<code>height</code>属性时，是直接返回<code>None</code>，并没
有报错，这是因为<code>__getattr__()</code>方法默认是返回<code>None</code>，我们只需要对不需要的属性调
用，加一个抛出异常的处理就可以了.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="s1">&#39;Zhazhahui&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;sex&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;GuTianle&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="s1">&#39;male&#39;</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="s1">&#39;female&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">Me</span><span class="se">\&#39;</span><span class="s1"> object has no attribute </span><span class="se">\&#39;</span><span class="si">{attr}</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span>
</span></span></code></pre></div><p>当然动态返回一个属性可以，返回一个方法当然也是可以的，比如给类加一个返回年龄的
方法：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;age&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="mi">20</span>
</span></span></code></pre></div><p>现在，虽然类中没有<code>age</code>方法，但是调用他并不会保错：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; me.age()
</span></span><span class="line"><span class="cl">20
</span></span></code></pre></div><h2 id="__iter__和__getitem__">__iter__和__getitem__</h2>
<p>如果一个类中定义了<code>__iter__()</code>或者<code>__getitem__()</code>方法，那么这个类就是可迭代类。</p>
<p>如果我们需要写一个迭代器类，即是希望一个类能被<code>for in</code>循环，就必须要定义一个
<code>__iter__()</code>方法，有了<code>__iter__()</code>方法，我们还需要<code>__next__()</code>方法
（<code>__next__()</code>不能还有参数）用来循环调用返回下一个值，知道遇到<code>StopIteration</code>错
误退出循环。我们以一个循环为例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Adder</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	    	<span class="k">raise</span> <span class="ne">StopIteration</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
</span></span></code></pre></div><p>循环这个<code>Adder()</code>实例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; for i in Adder():
</span></span><span class="line"><span class="cl">...    print(i)
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">1
</span></span><span class="line"><span class="cl">2
</span></span><span class="line"><span class="cl">3
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">100
</span></span></code></pre></div><p>虽然<code>__iter__()</code>方法只是返回自身，似乎只要实现<code>__next__()</code>方法就可以了，其实不
然，程序在循环迭代的时候会首先查找实例是否有<code>__iter__()</code>方法，来确定他是否是一
个迭代对象。如果我们去掉<code>__iter__()</code>方法，再次调用就会得到报错：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">TypeError: &#39;Adder&#39; object is not iterable
</span></span></code></pre></div><p>如果实例中没有<code>__iter__</code>但是有<code>__getitem__</code>的时候，也可以被迭代。循环会从<code>0</code>开
始依次读取相应的下标，直到发生<code>IndexError</code>为止：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">			<span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">a</span>
</span></span></code></pre></div><p>循环这个实例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; t = Test()
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; for i in t:
</span></span><span class="line"><span class="cl">...     print(i)
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">0
</span></span><span class="line"><span class="cl">1
</span></span><span class="line"><span class="cl">2
</span></span><span class="line"><span class="cl">......
</span></span></code></pre></div><p><code>__getitem__()</code>方法最主要的功能是让实例像list一样按住所以取出元素，仍然是上面的
例子：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; t = Test()
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; t[0]
</span></span><span class="line"><span class="cl">0
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; t[99]
</span></span><span class="line"><span class="cl">99
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; t[1000]
</span></span><span class="line"><span class="cl">1000
</span></span></code></pre></div><p>如果要想像 list 那样实现切片功能，就需要判断<code>__getitem__()</code>方法传入的参数是
<code>int</code>还是切片对象<code>slice</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">start</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">start</span>
</span></span><span class="line"><span class="cl">		<span class="n">stop</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">stop</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">stop</span> <span class="o">=</span> <span class="mi">100</span>
</span></span><span class="line"><span class="cl">		<span class="n">List</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">stop</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="n">List</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="n">List</span>
</span></span></code></pre></div><p>调用实例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; t = Test()
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; t[:10]
</span></span><span class="line"><span class="cl">[0,1,2,3,4,5,6,7,8,9]
</span></span></code></pre></div><p>当然这只是基础的切片处理，还有很多比如对<code>step</code>参数，负数，做处理。但是这也不难
看出<code>__getitem__()</code>的强大。对应的是<code>__setitem__()</code>方法，把对象视作 list 或 dict 
来对集合赋值。最后，还有<code>__delitem__()</code>方法，用于删除某个元素。</p>
<h2 id="__len__">__len__</h2>
<p>如果一个类的某个属性是一个集合，如果想要使用<code>len()</code>函数直接获取类的某个属性有多
少个属性，类必须提供一个<code>__len__()</code>方法，让他定义返回某个属性元素的个数：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">a</span><span class="p">,</span> <span class="n">test_list</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="n">a</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="n">test_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">test_list</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
</span></span></code></pre></div><p>调用测试：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;&gt;&gt; t = Test(10)
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; t
</span></span><span class="line"><span class="cl">[0, 2, 4, 6, 8]
</span></span><span class="line"><span class="cl">&gt;&gt;&gt; len(t)
</span></span><span class="line"><span class="cl">5
</span></span></code></pre></div><p>有了<code>__len__()</code>方法我们可以很方便的去定制我们的类，去返回我们需要返回的属性个
数。</p>
<h2 id="结尾">结尾</h2>
<p>本篇笔记主要总结了常遇到的<code>python</code>类的定制方法，不难看出这些定制方法可以让我们
很方便的定制一些特殊的类。至于还有一些比如实现加运算的：<code>__add__</code>，实现减运算
的：<code>__sub__</code>，乘和除运算的：<code>__mul__</code>,<code>__div__</code>。大家可以参考文档自己了解。</p>
</div>
                    <div class="post_footer">
                        
                        <div class="meta">
                            <div class="info">
                                <span class="field tags">
                                    <i class="ri-stack-line"></i>
                                    
                                    <a href="https://yokonsan.github.io/tags/python/">Python</a>
                                    
                                    <a href="https://yokonsan.github.io/tags/%E7%AC%94%E8%AE%B0/">笔记</a>
                                    
                                </span>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                
                <div class="doc_comments"></div>
                
            </div>
        </div>
    </div>
    <a id="back_to_top" href="#" class="back_to_top"><i class="ri-arrow-up-s-line"></i></a>
    <footer class="footer">
    <div class="powered_by">
        <a href="https://varkai.com">Designed by VarKai,</a>
        <a href="http://www.gohugo.io/">Proudly published with Hugo</a>
    </div>

    <div class="footer_slogan">
        <span>博观约取，厚积薄发</span>
    </div>
</footer>
    <script src="https://yokonsan.github.io/js/jquery-3.5.1.min.js"></script>
<link href="https://yokonsan.github.io/css/fancybox.min.css" rel="stylesheet">
<script src="https://yokonsan.github.io/js/fancybox.min.js"></script>
<script src="https://yokonsan.github.io/js/zozo.js"></script>


<script type="text/javascript" async
    src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
                processEscapes: true,
                processEnvironments: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                TeX: {
                    equationNumbers: { autoNumber: "AMS" },
                    extensions: ["AMSmath.js", "AMSsymbols.js"]
                }
            }
        });

        MathJax.Hub.Queue(function () {
            
            
            
            var all = MathJax.Hub.getAllJax(), i;
            for (i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

<style>
    code.has-jax {
        font: inherit;
        font-size: 100%;
        background: inherit;
        border: inherit;
        color: #515151;
    }
</style>



</body>

</html>